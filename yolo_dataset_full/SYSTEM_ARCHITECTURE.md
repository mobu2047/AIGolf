# ğŸŒï¸ é«˜å°”å¤«çƒæ†æ£€æµ‹ç³»ç»Ÿæ¶æ„è¯´æ˜

## ğŸ“‹ ç³»ç»Ÿæ¦‚è¿°

æœ¬ç³»ç»Ÿæ˜¯ä¸€ä¸ªå®Œæ•´çš„é«˜å°”å¤«çƒæ†æ£€æµ‹è®­ç»ƒæµæ°´çº¿ï¼ŒåŒ…å«è§†é¢‘æ ‡æ³¨å’Œè‡ªåŠ¨åŒ–è®­ç»ƒä¸¤ä¸ªæ ¸å¿ƒæ¨¡å—ï¼Œå®ç°äº†ä»è§†é¢‘è¾“å…¥åˆ°æ¨¡å‹è¾“å‡ºçš„å…¨è‡ªåŠ¨åŒ–æµç¨‹ã€‚

## ğŸ”„ æ•°æ®æµç¨‹

```
è§†é¢‘æ–‡ä»¶ â†’ è§†é¢‘æ ‡æ³¨ç³»ç»Ÿ â†’ æ•°æ®é›† â†’ è®­ç»ƒç³»ç»Ÿ â†’ æ¨¡å‹ + å·²è®­ç»ƒæ•°æ®å½’æ¡£
   â†“           â†“            â†“         â†“        â†“
videos/   â†’ dataset/   â†’ processed/ â†’ models/ + trained_data/
```

## ğŸ“ è·¯å¾„æ¶æ„

### å›ºå®šè·¯å¾„é…ç½®
- **è§†é¢‘è¾“å…¥**: `C:\Users\Administrator\Desktop\AIGolf\videos`
- **æ•°æ®é›†ä¸­è½¬**: `C:\Users\Administrator\Desktop\AIGolf\dataset`
- **è®­ç»ƒç³»ç»Ÿ**: `C:\Users\Administrator\Desktop\AIGolf\yolo_dataset_full`

### ç›®å½•ç»“æ„
```
C:\Users\Administrator\Desktop\AIGolf\
â”œâ”€â”€ videos/                    # ğŸ¬ ç”¨æˆ·è§†é¢‘è¾“å…¥
â”‚   â”œâ”€â”€ *.mp4, *.avi, *.mov   # æ”¯æŒå¤šç§è§†é¢‘æ ¼å¼
â”‚   â””â”€â”€ ...
â”œâ”€â”€ dataset/                   # ğŸ“Š æ•°æ®é›†ä¸­è½¬ç«™
â”‚   â”œâ”€â”€ images/               # è§†é¢‘æ ‡æ³¨ç³»ç»Ÿè¾“å‡ºçš„å›¾åƒ
â”‚   â”œâ”€â”€ annotations/          # è§†é¢‘æ ‡æ³¨ç³»ç»Ÿè¾“å‡ºçš„æ ‡æ³¨
â”‚   â””â”€â”€ processed_videos/     # å·²å¤„ç†è§†é¢‘è®°å½•
â””â”€â”€ yolo_dataset_full/        # ğŸ¤– è®­ç»ƒç³»ç»Ÿå·¥ä½œåŒº
    â”œâ”€â”€ processed/            # è®­ç»ƒæ•°æ®é›†
    â”œâ”€â”€ models/              # è®­ç»ƒæ¨¡å‹
    â”œâ”€â”€ trained_data/        # å·²è®­ç»ƒæ•°æ®å½’æ¡£
    â”œâ”€â”€ archive/             # å†å²æ•°æ®å¤‡ä»½
    â”œâ”€â”€ configs/             # é…ç½®æ–‡ä»¶
    â”œâ”€â”€ logs/               # æ—¥å¿—æ–‡ä»¶
    â””â”€â”€ temp/               # ä¸´æ—¶æ–‡ä»¶
```

## ğŸ§© æ ¸å¿ƒæ¨¡å—

### 1. è§†é¢‘æ ‡æ³¨ç³»ç»Ÿ (`video_annotation_system.py`)

**åŠŸèƒ½**ï¼š
- ä»è§†é¢‘ä¸­æå–å…³é”®å¸§
- äº¤äº’å¼æ ‡æ³¨çƒæ†ä½ç½®
- ç”ŸæˆYOLOæ ¼å¼æ ‡æ³¨æ–‡ä»¶
- é¿å…é‡å¤å¤„ç†å·²æ ‡æ³¨è§†é¢‘

**è¾“å…¥**ï¼š`C:\Users\Administrator\Desktop\AIGolf\videos\*.mp4`
**è¾“å‡º**ï¼š`C:\Users\Administrator\Desktop\AIGolf\dataset\`

**æ ¸å¿ƒç‰¹æ€§**ï¼š
- æ”¯æŒå¤šç§è§†é¢‘æ ¼å¼ (.mp4, .avi, .mov, .mkv, .wmv)
- æ™ºèƒ½å¸§æå–ï¼ˆå¯é…ç½®é—´éš”å’Œæœ€å¤§å¸§æ•°ï¼‰
- å¤šç§æ ‡æ³¨æ¨¡å¼ï¼ˆæ—‹è½¬è¾¹ç•Œæ¡†ã€è½´å¯¹é½è¾¹ç•Œæ¡†ã€çº¿æ®µã€å¤šè¾¹å½¢ï¼‰
- å±å¹•è‡ªé€‚åº”æ˜¾ç¤º
- è§†é¢‘å»é‡æœºåˆ¶

### 2. è‡ªåŠ¨è®­ç»ƒç³»ç»Ÿ (`auto_training_system.py`)

**åŠŸèƒ½**ï¼š
- è‡ªåŠ¨æ£€æµ‹æ–°æ ‡æ³¨æ•°æ®
- æ™ºèƒ½é€‰æ‹©è®­ç»ƒç­–ç•¥
- æ‰§è¡ŒYOLOæ¨¡å‹è®­ç»ƒ
- ç®¡ç†å·²è®­ç»ƒæ•°æ®

**è¾“å…¥**ï¼š`C:\Users\Administrator\Desktop\AIGolf\dataset\`
**è¾“å‡º**ï¼š`yolo_dataset_full/models/latest/best.pt`

**æ ¸å¿ƒç‰¹æ€§**ï¼š
- å¢é‡è®­ç»ƒæ”¯æŒ
- å¤šæ ¼å¼æ•°æ®è½¬æ¢ (COCO, VOC, YOLO)
- è‡ªåŠ¨æ•°æ®å»é‡
- æ™ºèƒ½å‚æ•°è°ƒæ•´
- å®Œæ•´çš„æ•°æ®å½’æ¡£

### 3. æ•°æ®ç®¡ç†ç³»ç»Ÿ

**å·²è®­ç»ƒæ•°æ®å½’æ¡£**ï¼š
- è®­ç»ƒå®Œæˆåè‡ªåŠ¨ç§»åŠ¨æ•°æ®åˆ° `trained_data/`
- æŒ‰æ‰¹æ¬¡ç»„ç»‡ï¼Œä¾¿äºè¿½æº¯
- å®Œæ•´çš„å…ƒæ•°æ®è®°å½•

**æ•°æ®æµè½¬**ï¼š
1. è§†é¢‘ â†’ æ ‡æ³¨æ•°æ® (videos â†’ dataset)
2. æ ‡æ³¨æ•°æ® â†’ è®­ç»ƒæ•°æ® (dataset â†’ processed)
3. è®­ç»ƒæ•°æ® â†’ å½’æ¡£æ•°æ® (dataset â†’ trained_data)

## âš™ï¸ é…ç½®å‚æ•°

### è§†é¢‘æ ‡æ³¨å‚æ•°
```python
# é»˜è®¤é…ç½®
mode='rotated_bbox'           # æ ‡æ³¨æ¨¡å¼
frame_interval=10             # å¸§é—´éš”
max_frames_per_video=50       # æ¯è§†é¢‘æœ€å¤§å¸§æ•°
```

### è®­ç»ƒå‚æ•°
```python
# è‡ªåŠ¨è°ƒæ•´çš„å‚æ•°
epochs: 100 (æ–°è®­ç»ƒ) / 50 (å¢é‡è®­ç»ƒ)
learning_rate: 0.01 (æ–°è®­ç»ƒ) / 0.001 (å¢é‡è®­ç»ƒ)
batch_size: 8/16/32 (æ ¹æ®æ•°æ®é›†å¤§å°)
```

## ğŸ”§ æ ¸å¿ƒç®—æ³•

### 1. è‡ªé€‚åº”çƒæ†å®½åº¦è®¡ç®—
```python
def calculate_adaptive_width(img_width, img_height, club_length):
    base_width = img_width * 0.002  # åŸºç¡€å®½åº¦æ¯”ä¾‹
    max_width = img_width * 0.008   # æœ€å¤§å®½åº¦æ¯”ä¾‹
    
    # æ ¹æ®çƒæ†é•¿åº¦è°ƒæ•´
    if club_length < img_width * 0.1:
        width_factor = 0.8      # çŸ­æ†
    elif club_length < img_width * 0.3:
        width_factor = 1.0      # ä¸­æ†
    else:
        width_factor = 1.2      # é•¿æ†
    
    return max(min(base_width * width_factor, max_width), 3)
```

### 2. æ—‹è½¬è¾¹ç•Œæ¡†è®¡ç®—
```python
def calculate_rotated_bbox(point1, point2, width):
    direction = point2 - point1
    direction_norm = direction / np.linalg.norm(direction)
    perpendicular = np.array([-direction_norm[1], direction_norm[0]])
    half_width = width / 2
    
    corners = [
        point1 + perpendicular * half_width,  # å·¦ä¸Š
        point2 + perpendicular * half_width,  # å³ä¸Š
        point2 - perpendicular * half_width,  # å³ä¸‹
        point1 - perpendicular * half_width   # å·¦ä¸‹
    ]
    return corners
```

### 3. æ™ºèƒ½è®­ç»ƒç­–ç•¥é€‰æ‹©
```python
def determine_training_strategy(latest_model, new_data):
    if not latest_model:
        return "fresh_training"     # å…¨æ–°è®­ç»ƒ
    elif new_data:
        return "incremental"        # å¢é‡è®­ç»ƒ
    else:
        return "resume"            # æ¢å¤è®­ç»ƒ
```

## ğŸš€ å¯åŠ¨è„šæœ¬

### ç®€åŒ–å¯åŠ¨è„šæœ¬
- `start_video_annotation.py`: ä¸€é”®å¯åŠ¨è§†é¢‘æ ‡æ³¨
- `train_yolo_auto.py`: ä¸€é”®å¯åŠ¨è®­ç»ƒ

### å®Œæ•´åŠŸèƒ½è„šæœ¬
- `video_annotation_system.py`: å®Œæ•´è§†é¢‘æ ‡æ³¨ç³»ç»Ÿ
- `auto_training_system.py`: å®Œæ•´è‡ªåŠ¨è®­ç»ƒç³»ç»Ÿ

## ğŸ“Š æ•°æ®æ ¼å¼

### è§†é¢‘æ ‡æ³¨è¾“å‡ºæ ¼å¼
```
dataset/
â”œâ”€â”€ images/
â”‚   â””â”€â”€ video1_frame_000001_20231201_143022_123456.jpg
â”œâ”€â”€ annotations/
â”‚   â”œâ”€â”€ video1_frame_000001_20231201_143022_123456.txt      # YOLOæ ¼å¼
â”‚   â””â”€â”€ video1_frame_000001_20231201_143022_123456_detail.json  # è¯¦ç»†ä¿¡æ¯
â””â”€â”€ processed_videos/
    â””â”€â”€ processed_list.json
```

### YOLOæ ‡æ³¨æ ¼å¼
```
# .txtæ–‡ä»¶å†…å®¹
0 0.5 0.3 0.1 0.6
# æ ¼å¼: class_id x_center y_center width height (å½’ä¸€åŒ–åæ ‡)
```

### è¯¦ç»†æ ‡æ³¨æ ¼å¼
```json
{
  "mode": "rotated_bbox",
  "points": [[x1, y1], [x2, y2]],
  "length": 400.5,
  "angle": 15.3,
  "club_width": 12.0,
  "image_size": [1920, 1080],
  "frame_info": {
    "video_name": "golf_swing_1",
    "frame_index": 100,
    "timestamp": 3.33
  }
}
```

## ğŸ” é”™è¯¯å¤„ç†

### è§†é¢‘æ ‡æ³¨é”™è¯¯å¤„ç†
- è§†é¢‘æ–‡ä»¶æŸåæ£€æµ‹
- å¸§æå–å¤±è´¥å¤„ç†
- æ˜¾ç¤ºçª—å£å¼‚å¸¸å¤„ç†

### è®­ç»ƒç³»ç»Ÿé”™è¯¯å¤„ç†
- æ•°æ®æ ¼å¼éªŒè¯
- å†…å­˜ä¸è¶³å¤„ç†
- GPU/CPUè‡ªåŠ¨åˆ‡æ¢
- è®­ç»ƒä¸­æ–­æ¢å¤

## ğŸ“ˆ æ€§èƒ½ä¼˜åŒ–

### è§†é¢‘å¤„ç†ä¼˜åŒ–
- æ™ºèƒ½å¸§é€‰æ‹©ç®—æ³•
- è§†é¢‘å“ˆå¸Œå»é‡
- å†…å­˜é«˜æ•ˆçš„å¸§å¤„ç†

### è®­ç»ƒä¼˜åŒ–
- è‡ªåŠ¨æ‰¹æ¬¡å¤§å°è°ƒæ•´
- æ™ºèƒ½å­¦ä¹ ç‡è°ƒåº¦
- æ—©åœæœºåˆ¶

## ğŸ”’ æ•°æ®å®‰å…¨

### æ•°æ®å¤‡ä»½ç­–ç•¥
- è‡ªåŠ¨æ•°æ®å½’æ¡£
- å®Œæ•´çš„å¤„ç†æ—¥å¿—
- å¯è¿½æº¯çš„æ•°æ®ç‰ˆæœ¬

### é”™è¯¯æ¢å¤
- è¯¦ç»†çš„é”™è¯¯æ—¥å¿—
- æ•°æ®å®Œæ•´æ€§éªŒè¯
- è‡ªåŠ¨æ¢å¤æœºåˆ¶

## ğŸ¯ ä½¿ç”¨å»ºè®®

### æœ€ä½³å®è·µ
1. **è§†é¢‘è´¨é‡**: ä½¿ç”¨é«˜è´¨é‡ã€ç¨³å®šçš„è§†é¢‘
2. **æ ‡æ³¨ä¸€è‡´æ€§**: ä¿æŒæ ‡æ³¨ç‚¹çš„ä¸€è‡´æ€§
3. **æ•°æ®å¹³è¡¡**: ç¡®ä¿ä¸åŒåœºæ™¯çš„æ•°æ®å¹³è¡¡
4. **å®šæœŸå¤‡ä»½**: å®šæœŸå¤‡ä»½é‡è¦çš„è®­ç»ƒæ¨¡å‹

### æ€§èƒ½è°ƒä¼˜
1. **å¸§é—´éš”è°ƒæ•´**: æ ¹æ®è§†é¢‘å†…å®¹è°ƒæ•´å¸§æå–é—´éš”
2. **æ‰¹æ¬¡å¤§å°**: æ ¹æ®ç¡¬ä»¶é…ç½®è°ƒæ•´è®­ç»ƒæ‰¹æ¬¡
3. **æ•°æ®å¢å¼º**: è€ƒè™‘æ·»åŠ æ•°æ®å¢å¼ºç­–ç•¥

## ğŸ”® æ‰©å±•æ€§

### æ¨¡å—åŒ–è®¾è®¡
- ç‹¬ç«‹çš„è§†é¢‘å¤„ç†æ¨¡å—
- å¯æ’æ‹”çš„æ ‡æ³¨æ¨¡å¼
- çµæ´»çš„è®­ç»ƒç­–ç•¥

### æœªæ¥æ‰©å±•
- æ”¯æŒæ›´å¤šè§†é¢‘æ ¼å¼
- æ·»åŠ è‡ªåŠ¨æ ‡æ³¨åŠŸèƒ½
- é›†æˆæ¨¡å‹è¯„ä¼°å·¥å…·
- æ”¯æŒåˆ†å¸ƒå¼è®­ç»ƒ

---

## ğŸ“ æŠ€æœ¯æ”¯æŒ

å¦‚éœ€æŠ€æœ¯æ”¯æŒï¼Œè¯·ï¼š
1. æŸ¥çœ‹ç³»ç»Ÿæ—¥å¿— (`logs/`)
2. è¿è¡Œç³»ç»Ÿæµ‹è¯• (`python test_system.py`)
3. å‚è€ƒæ•…éšœæ’é™¤æŒ‡å—
4. æä¾›è¯¦ç»†çš„é”™è¯¯ä¿¡æ¯ 